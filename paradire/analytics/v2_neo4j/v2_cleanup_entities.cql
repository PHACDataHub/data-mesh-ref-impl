/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
// Removing FAR_*/FAS_* Records
//
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
WITH ['FAR', 'FAS'] AS entity_list
    UNWIND entity_list AS entity
WITH entity, SPLIT('1,2,3,4,5,6,7,8,9', ',') AS counter_list
    UNWIND counter_list AS counter
WITH 
    'MATCH (n:' + entity + '_' + counter + ') RETURN n' AS batch_producer,
    ' WITH n DETACH DELETE n' AS batch_runner
WITH batch_producer, batch_runner
    CALL apoc.periodic.iterate(batch_producer, batch_runner, {batchSize:10000, parallel:true})
        YIELD total RETURN total;
//
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
