/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
// Process events from fed_response_vaccination_record topic into VaccinationRecord nodes
//
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
CREATE (n:VaccinationRecord)
    SET n.request_id = event.request_id,
        n.immunization_date = event.immunization_date,
        n.immunization_code = event.immunization_description
        n.immunization_description = event.immunization_description,
        n.organization_name = event.organization_name,
        n.organization_zip = event.organization_zip,
        n.encounter_class = event.encounter_class,
        n.encounter_code = event.encounter_code,
        n.encounter_description = event.encounter_description,
        n.patient_id = event.patient_id,
        n.patient_address = event.patient_address,
        n.patient_age = event.patient_age,
        n.patient_zip = event.patient_zip,
        n.patient_gender = event.patient_gender,
        n.patient_race = event.patient_race,
        n.patient_ethnicity = event.patient_ethnicity,
        n.pt = event.pt,
        n.timestamp = event.timestamp
//
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
// Process events from fed_response_zip_immunization topic into ZipImmunization nodes
//
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
CREATE (n:ZipImmunization)
    SET n.request_id = event.request_id,
        n.patient_city = event.patient_city,
        n.patient_zip = event.patient_zip,
        n.immunization_count = event.immunization_count, 
        n.pt = event.pt,
        n.timestamp = event.timestamp
//
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
// Process events from fed_response_top_k_immunization topic into TopKImmunization nodes
//
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
CREATE (n:TopKImmunization)
    SET n.request_id = event.request_id,
        n.patient_zip = event.patient_zip,
        n.immunization_code = event.immunization_code,
        n.immunization_count = event.immunization_count, 
        n.pt = event.pt,
        n.timestamp = event.timestamp
//
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
// Process events from fed_response_patient_cvx_org topic into PatientCvxOrg nodes
//
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
CREATE (n:PatientCvxOrg)
    SET n.request_id = event.request_id,
        n.patient_id = event.patient_id,
        n.patient_birth_date = event.birth_date,
        n.patient_gender = event.patient_gender, 
        n.patient_zip = event.patient_zip, 
        n.code_list = event.code_list,
        n.immunization_count = event.immunization_count, 
        n.organization_name = event.organization.name, 
        n.organization_zip = event.organization.zip, 
        n.pt = event.pt,
        n.timestamp = event.timestamp
//
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
// Process events from fed_response_city_year_top_proc topic into CityYearTopProc nodes
//
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
CREATE (n:CityYearTopProc)
    SET n.request_id = event.request_id,
        n.organization_city = event.organization_city,
        n.year = event.year,
        n.procedure_1 = event.procedure_1,
        n.procedure_2 = event.procedure_2,
        n.procedure_3 = event.procedure_3,
        n.pt = event.pt,
        n.timestamp = event.timestamp
//
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
// Process events from fed_response_pt_org_med topic into PtOrgMed nodes
//
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
CREATE (n:PtOrgMed)
    SET n.request_id = event.request_id,
        n.organization_city = event.organization_city,
        n.organization_state = event.organization_state,
        n.organization_name = event.organization_name,
        n.medication_count = event.medication_count,
        n.pt = event.pt,
        n.timestamp = event.timestamp
//
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
// Process events from fed_response_city_org_patient topic into CityOrgPatient nodes
//
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
CREATE (n:CityOrgPatient)
    SET n.request_id = event.request_id,
        n.organization_city = event.organization_city,
        n.organization_name = event.organization_name,
        n.patient_count = event.patient_count, 
        n.pt = event.pt,
        n.timestamp = event.timestamp
//
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
// Process events from fed_response_city_org_patient_visit topic into CityOrgPatientVisit nodes
//
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
CREATE (n:CityOrgPatientVisit)
    SET n.request_id = event.request_id,
        n.organization_city = event.organization_city,
        n.organization_name = event.organization_name,
        n.patient_id = event.patient_id,
        n.encounter_count = event.encounter_count, 
        n.pt = event.pt,
        n.timestamp = event.timestamp
//
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
